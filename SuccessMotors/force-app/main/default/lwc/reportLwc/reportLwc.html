<template>

  <template if:true={view}>

      <lightning-card>

          <template if:true={singleAccount.data}>
              <h1 style="font-size: 24px; font-weight:500; text-align:center">Account Closed Opportunities</h1>

              <div class="opps-with-buttons" style="display: flex; gap:20px; margin-left:20px;">

                  <div class="opps-block">
                      <template for:each={singleAccount.data.Opportunities} for:item="p">
                          <p key={p.Id} style="margin-top: 18px;">{p.Name}={p.Amount}</p>
                      </template>
                      <p style="margin-top: 20px; font-weight:700;" if:true={singleAccount.data.Closed_Opportunities_Sum__c}>Sum = {singleAccount.data.Closed_Opportunities_Sum__c}</p>
                  </div>

                  <div class="buttons-block" style="display: flex; flex-direction:column;">
                      <template for:each={singleAccount.data.Opportunities} for:item="p">
                          <lightning-button key={p.Id} label="Products" style="margin-top: 10px;" data-button-id={p.Id} onclick={buttonsHandler}>
                          </lightning-button>
                      </template>
                  </div>

              </div>

              <div class="dates" style="margin-left: 20px;">
                  <p style="margin-top: 20px;" if:true={singleAccount.data.Opportunities}>Created/Closed dates:</p>
                  <template for:each={singleAccount.data.Opportunities} for:item="p">
                      <p key={p.Id} style="margin-top: 10xp;">{p.Name}(
                          <lightning-formatted-date-time value={p.CreatedDate}>

                          </lightning-formatted-date-time>/
                          <lightning-formatted-date-time value={p.CloseDate}>

                          </lightning-formatted-date-time>)
                      </p>
                  </template>
              </div>

              <template if:false={singleAccount.data.Opportunities}>
                  <h2 style="font-size: 20px; font-weight:300; text-align:center">No Closed Opportunities for this Account</h2>
              </template>

          </template>

      </lightning-card>

  </template>

  <template if:false={view}>

      <lightning-card>

          <h1 style="font-size: 24px; font-weight:500; text-align:center">Accounts with Closed Opportunities</h1>

          <lightning-input placeholder="Type Account Name or Opportunities Sum to search" type="text" name="search-input" class="search-input" onchange={searchHandler}></lightning-input>


          <lightning-accordion>
              <template for:each={visibleAccounts} for:item="acc">
                  <lightning-accordion-section key={acc.Id} label={acc.Name}>

                      <h2 style="font-size: 18px; font-weight:700;" if:true={acc.Opportunities}>Closed Opportunities: </h2>
                      <h2 style="font-size: 18px; font-weight:700;" if:false={acc.Opportunities}>No Closed Opportunities</h2>

                      <div class="opps-with-buttons" style="display: flex; gap:20px;">

                          <div class="opps-block">
                              <template for:each={acc.Opportunities} for:item="p">

                                  <a key={p.Id} style="display: block; margin-top:20px;" data-target-id={p.Id} class="opp-link" onclick={linksHandler}>
                                      {p.Name} = <span class="amount">{p.Amount}</span>
                                  </a>

                              </template>

                              <p class="sum" style="font-weight: 700; margin-top:20px;" if:true={acc.Closed_Opportunities_Sum__c}>Sum = {acc.Closed_Opportunities_Sum__c}</p>
                          </div>

                          <div class="buttons-block" style="display: flex; flex-direction:column;">
                              <template for:each={acc.Opportunities} for:item="p">
                                  <lightning-button key={p.Id} label="Products" style="margin-top: 10px;" data-button-id={p.Id} onclick={buttonsHandler}>
                                  </lightning-button>
                              </template>
                          </div>
                      </div>

                      <p style="margin-top: 20px;" if:true={acc.Opportunities}>Created/Closed dates:</p>
                      <template for:each={acc.Opportunities} for:item="p">
                          <p key={p.Id} style="margin-top: 10xp;">{p.Name}(
                              <lightning-formatted-date-time value={p.CreatedDate}>

                              </lightning-formatted-date-time>/
                              <lightning-formatted-date-time value={p.CloseDate}>

                              </lightning-formatted-date-time>)
                          </p>
                      </template>

                  </lightning-accordion-section>
              </template>
          </lightning-accordion>
          <div slot="footer" class="slds-var-m-vertical_medium">
              <c-pagination records={accounts.data} record-size="10" onupdate={updateAccountHandler}></c-pagination>
          </div>
      </lightning-card>
  </template>
</template>